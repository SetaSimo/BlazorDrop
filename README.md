![.NET 6](https://img.shields.io/badge/.NET-6-blue)
![.NET 8](https://img.shields.io/badge/.NET-8-blueviolet)

# BlazorDrop

**BlazorDrop** is a lightweight and flexible Blazor component library for building searchable, lazy-loaded dropdowns with support for virtual scrolling, async filtering, custom templates, and both single- and multi-select modes.

## Features

- Asynchronous data loading by pages
- Search by input text with debounce
- Scroll-to-end detection for infinite loading
- Multi-select support with dynamic list rendering
- Value change binding
- Custom display selector
- Loading indicator while fetching data
- Disabled state support
- Designed for .NET Core 3.1
- Custom item templates

## Installation

You can install the library via NuGet:

```bash
dotnet add package BlazorDrop
```

## Required Imports

To use templates, make sure you import the following namespaces in your `.razor` file or `_Imports.razor`:

```razor
@using BlazorDrop
@using BlazorDrop.Components
```

Then reference the JavaScript and CSS in your host page:

- For **Blazor WebAssembly**: `wwwroot/index.html`
- For **Blazor Server**: `_Host.cshtml`

```html
<script src="_content/BlazorDrop/BlazorDropSelect.js"></script>
<link rel="stylesheet" href="_content/BlazorDrop/BlazorDropSelect.css" />
<link
  href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"
  rel="stylesheet"
/>
```

## Usage

## BlazorDropSelect

![Select](https://github.com/user-attachments/assets/e55fec59-044d-4b8b-a4d0-643c7101606e)

```razor
<BlazorDropSelect
        T="KeyValuePair<Guid, string>"
        DisplaySelector="@(x => x.Value)"
        OnLoadItemsAsync="LoadPageAsync"
        OnSearchAsync="SearchForItemAsync"
        OnItemClickAsync="OnValueChanged"
        ShowLoadingIndicator="true"
        Disabled="false"
        Placeholder="Select value"
        UpdateSearchDelayInMilliseconds="600"
        PageSize="10"
        ValueNotFoundMessageText="Not fount"
        Class="active-select"
        Id="select-enabled"
        CurrentPage="@(0)"
        Value="@_selectedItem" />
```

### Parameters

| Parameter                         | Type                                   | Description                                          |
| --------------------------------- | -------------------------------------- | ---------------------------------------------------- |
| `T`                               | `generic`                              | Type of the items in the dropdown                    |
| `Id`                              | `string`                               | Optional unique ID (auto-generated by default)       |
| `Class`                           | `string`                               | Optional CSS class for the component                 |
| `Style`                           | `string`                               | Optional inline CSS style applied to the container   |
| `Placeholder`                     | `string`                               | Placeholder text when nothing is selected            |
| `ValueNotFoundMessageText`        | `string`                               | Message shown when no matching value is found        |
| `PageSize`                        | `int`                                  | Number of items to load per page (default: 20)       |
| `CurrentPage`                     | `int`                                  | Initial page index for paging (default: 0)           |
| `UpdateSearchDelayInMilliseconds` | `int`                                  | Debounce delay for input search (default: 1000 ms)   |
| `Value`                           | `T`                                    | Currently selected item / default value              |
| `OnValueChangedAsync`             | `Func<T, Task<T>>`                     | Callback for selection change                        |
| `ItemTemplate`                    | `RenderFragment<T>`                    | Optional custom template for each list item          |
| `DisplaySelector`                 | `Func<T, string>`                      | Function to extract display text from item           |
| `OnLoadItemsAsync`                | `Func<int, int, Task<IEnumerable<T>>>` | Async method for loading paginated items             |
| `OnSearchAsync`                   | `Func<string, Task<IEnumerable<T>>>`   | Async method for searching items by text             |
| `ShowLoadingIndicator`            | `bool`                                 | Show loading spinner during async operations         |
| `Disabled`                        | `bool`                                 | Disables the input and interaction with the dropdown |

### Example Code

```csharp
private Dictionary<Guid, string> _testValues = new();

private KeyValuePair<Guid, string> _selectedItem;

protected override async Task OnInitializedAsync()
{
    for (int i = 0; i < 1000; i++)
    {
        var id = Guid.NewGuid();
        _testValues.Add(id, $"Record {i}");
    }
}

private Task<IEnumerable<KeyValuePair<Guid, string>>> LoadPageAsync(int page, int pageSize)
{
    return Task.FromResult(_testValues.Skip(page * pageSize).Take(pageSize));
}

private Task<IEnumerable<KeyValuePair<Guid, string>>> SearchForItemAsync(string text)
{
    return Task.FromResult(_testValues.Where(x => x.Value.Contains(text)));
}

private Task<KeyValuePair<Guid, string>> OnValueChanged(KeyValuePair<Guid, string> item)
{
    _selectedItem = item;
    return Task.FromResult(item);
}
```

### BlazorDropList

`BlazorDropList` is a Blazor component designed to render a virtualized, scrollable dropdown-style list that supports lazy loading and custom item display. It is styled according to Material Design principles.

![List](https://github.com/user-attachments/assets/ab3eb98d-c179-4b7e-af3b-6109ded34b0f)

```razor
<BlazorDropList
        T="KeyValuePair<Guid, string>"
        DisplaySelector="@(x => x.Value)"
        OnLoadItemsAsync="LoadPageAsync"
        OnItemClickAsync="OnValueChanged"
        ShowLoadingIndicator="true"
        PageSize="10"
        ValueNotFoundMessageText="Not fount"
        Class="drop-list"
        Id="drop-list"
        CurrentPage="@(0)"
        Value="@_selectedItemInDisabledSelect">
</BlazorDropList>
```

### Parameters

| Parameter                  | Type                                   | Description                                                  |
| -------------------------- | -------------------------------------- | ------------------------------------------------------------ |
| `T`                        | `generic`                              | Type of the items rendered in the list                       |
| `Id`                       | `string`                               | Optional unique identifier (auto-generated by default)       |
| `Class`                    | `string`                               | Optional CSS class for the list container                    |
| `Style`                    | `string`                               | Optional inline CSS style applied to the container           |
| `DisplaySelector`          | `Func<T, string>`                      | Function to extract display text from each item              |
| `Value`                    | `T`                                    | Currently selected item                                      |
| `PageSize`                 | `int`                                  | Number of items to load per page (default: 20)               |
| `CurrentPage`              | `int`                                  | Index of the initial page (default: 0)                       |
| `ItemTemplate`             | `RenderFragment<T>`                    | Optional custom template for each list item                  |
| `OnLoadItemsAsync`         | `Func<int, int, Task<IEnumerable<T>>>` | Async function for loading paginated items                   |
| `OnItemClickAsync`         | `Func<T, Task>`                        | Async callback triggered when an item is clicked             |
| `ValueNotFoundMessageText` | `string`                               | Message shown when no items are found                        |
| `ShowLoadingIndicator`     | `bool`                                 | Whether to display a loading spinner during async data fetch |

### Example Code

```csharp
private Dictionary<Guid, string> _testValues = new();

private KeyValuePair<Guid, string> _selectedItem;

protected override async Task OnInitializedAsync()
{
    for (int i = 0; i < 1000; i++)
    {
        var id = Guid.NewGuid();
        _testValues.Add(id, $"Record {i}");
    }
}

private Task<IEnumerable<KeyValuePair<Guid, string>>> LoadPageAsync(int page, int pageSize)
{
    return Task.FromResult(_testValues.Skip(page * pageSize).Take(pageSize));
}

private Task<IEnumerable<KeyValuePair<Guid, string>>> SearchForItemAsync(string text)
{
    return Task.FromResult(_testValues.Where(x => x.Value.Contains(text)));
}

private Task<KeyValuePair<Guid, string>> OnValueChanged(KeyValuePair<Guid, string> item)
{
    _selectedItem = item;
    return Task.FromResult(item);
}
```

### BlazorDropMultiSelect

`BlazorDropMultiSelect` is an extension of `BlazorDropSelect` supporting multi-value selection with the same lazy-loading and searchable capabilities.

```razor
<BlazorDropMultiSelect
        T="KeyValuePair<Guid, string>"
        DisplaySelector="@(x => x.Value)"
        OnLoadItemsAsync="LoadPageAsync"
        OnSearchAsync="SearchForItemAsync"
        OnItemClickAsync="OnMultiSelectChanged"
        ShowLoadingIndicator="true"
        Disabled="false"
        Placeholder="Select values"
        PageSize="10"
        Class="multi-select"
        Id="select-multi"
        CurrentPage="@(0)"
        SelectedValues="@_selectedItems" />
```

Parameters (additional to `BlazorDropSelect`):
| Parameter | Type | Description |
| ---------------- | ---------------- | -------------------------------------------------- |
| `SelectedValues` | `IEnumerable<T>` | List of selected items in multi-select mode |
| `Style` | `string` | Optional inline CSS style applied to the container |

## Custom Item Template

You can customize how each dropdown item is rendered using the `ItemTemplate` parameter. This allows you to change formatting or apply custom styles.

```razor
<BlazorDropSelect T="KeyValuePair<Guid, string>"
                  Placeholder="With custom template"
                  Value="@_templatedSelect"
                  DisplaySelector="@(x => x.Value)"
                  OnLoadItemsAsync="LoadItemsPagedAsync"
                  OnSearchTextChangedAsync="SearchByTextAsync"
                  OnItemClickAsync="OnTemplateItemSelected"
                  ValueNotFoundMessageText="Not found">

    <ItemTemplate Context="item">
        <span class="text-success fw-semibold">@item.Value</span>
    </ItemTemplate>

</BlazorDropSelect>
```

Notes

- ItemTemplate accepts a RenderFragment<T> where T is the item type.
- If specified, this replaces the default item rendering.
- You can apply Bootstrap or custom CSS styles inside the template.

## Loading Indicator Components

`BlazorDropCircularProgressBar` and `BlazorDropLinearProgressBar` are a lightweight, reusable components that renders a Material-style loading bar to indicate asynchronous data loading.

### Parameters

| Parameter | Type     | Description                                              |
| --------- | -------- | -------------------------------------------------------- |
| `Id`      | `string` | Optional unique identifier (auto-generated by default).  |
| `Class`   | `string` | Optional CSS class for additional styling customization. |
| `Style`   | `string` | Optional inline CSS style applied to the container       |

## .NET Compatibility

| BlazorDrop Version | Supported .NET Versions                        |
| ------------------ | ---------------------------------------------- |
| < 2.0.0            | .NET Core 3.1                                  |
| ≥ 2.0.0            | .NET 6, .NET 8                                 |
|                    | .NET 7, .NET 9 (not tested, potentially works) |

## Notes

- Scroll detection triggers when the user reaches the bottom of the dropdown list.
- Click outside and scroll handlers are automatically attached and detached.
